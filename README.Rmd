---
title: yspec
author: ""
date: ""
scientist: MRG
projectnumber: yspec
output: github_document
---


```{r,"setup-0",echo = FALSE}
knitr::opts_chunk$set(comment = '.', message = FALSE)
```


## About

- Write data set specification data in `yaml` format
    - [About the format](./inst/doc/reference.md)
- The `yspec` package reads the specification and 
further formats the data
    - For example, [splitting data columns by other data items](./inst/doc/reference.md#split-data-column)
- Information can be accessed or utilized by other functions
in the ecosystem
- `yspec` will render a [`Define.pdf`](./inst/readme_docs/fda_define.pdf) document or output
in any other format supported by `rmarkdown`

## Use
```{r, "setup-1"}
library(yspec)
```

We can load [this yaml file](inst/spec/spec.yml)

```{r, "demo-1"}
sp <- load_spec("inst/spec/spec.yml")
head(sp)
```

See [here](./inst/doc/reference.md) for `YAML` specification details


A lot like the current spec setup
```{r, "demo-2", comment='.'}
names(sp)
sp$WT$unit
```

```{r, "pander-table", results = "asis"}
writeLines(yspec:::pander_table(sp))
```


```{r, "out-dir", echo = FALSE}
output__dir <- normalizePath("inst/readme_docs")
```

Render in pdf format
```{r, "render-1", echo=TRUE, results="hide", message=FALSE}
render_spec(sp, 
            stem = "define", 
            output_format = "pdf_document",
            output_dir = "inst/readme_docs")
```

with output [here](./inst/readme_docs/define.pdf)


Or render to any format
```{r, "render-2", echo=TRUE, results="hide", message=FALSE}
render_spec(sp, stem = "define_example", 
            envir  = new.env(),
            output_format="md_document",
            output_dir = "inst/readme_docs")
```

Then we get [this output](./inst/readme_docs/define_example.md)



## Build a `define.pdf` document

To make a proper `define.pdf` document, create another 
yaml file that points to data set specific files. 

For example [./inst/spec/project.yml](./inst/spec/project.yml)

Then render it:

```{r, "render-define-1", echo = TRUE, results = "hide", message = FALSE}
render_define(file = "inst/spec/project.yml", 
              stem = "project", envir = new.env(),
              output_format = "pdf_document",
              output_dir = "inst/readme_docs",
              title = "DEM104101 PK/PD Analysis Data Sets")
```

Output [here](./inst/readme_docs/project.pdf)

## Build a `define.pdf` document for sending to FDA
```{r, "render-fda-define", results = "hide"}
render_fda_define(spec_ex_proj(), 
                  stem = "fda_define",
                  build_dir = yspec:::mrgtemplate(),
                  output_dir = "inst/readme_docs")
```

Output [here](./inst/readme_docs/fda_define.pdf)






